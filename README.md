# shortcut.ps1

通称：ファイルサーバの深い場所にあるフォルダ/ファイルを一発で開くPowershellツール

URL:https://github.com/minsk19/shortcut

## 1.概要

ファイルサーバの深いフォルダにすぐにアクセスできるように、MacのSpotlightのような機能をPowerShellで書いた。

## 2.構成

4つのファイルで構成
1. README.md

* このファイル
  * このファイル
 このファイル

2. shortcut.bat

* 本体を実行するためのバッチファイル
* デスクトップにショートカット作成やスタートアップに登録しておくと捗る。
  * PowerShellファイルを直接起動できない環境が多いのでバッチファイルから起動する形式にしている。

3. shortcut.ps1

* 本体

4. shortcut.txt

* 設定ファイル
* 検索で引っかてほしいキーワード、その次の行にフォルダパス　を書いていく。
* 行頭が#の行はコメントアウトとなる。大項目の分類とかに使うのもおすすめ。
* 奇数行・偶数行の縛りはなくなった(version2から)。
* 詳しい説明はファイルに記載。
* 有名拡張子のファイルは自動で暗号化されるセキュリティ意識の高い環境では拡張子を```.txtt```等に変更するのがおすすめ。

## 3.初期設定

1. 4つのファイルを同一ディレクトリに配置する。

2. バッチファイルを編集(shortcut.bat)

* 3行目""の中身をshortcut.ps1ファイルを置いた場所に変更する。

3. 設定を入れる(shortcut.ps1)

* 5行目から35行目くらいにある変数の値を必要に応じて編集する。
* 編集が必要な変数
  * ```$config_file_name_1``` →設定ファイル名を変えたらここを合わせる。
  * ```$sakura``` →サクラエディタでなくても良いが、なにかのテキストエディタのパスを登録する。
  * その他は初期設定のままでもとりあえずは動く。

4. 設定ファイルを編集する(shortcut.txt)

* ファイルの最初の方にある説明を参考に、よく使うフォルダやファイルやURLを登録する。

## 4.使い方

* shortcut.batを起動すると```>>:```でプロンプトが表示される。
* 検索キーワードを入れてEnterで、候補一覧が表示される。
* 開きたいフォルダの数字を入れてEnterでそのフォルダが開く。URLの場合はChromeで開く。


## 5.便利な使い方

### 特殊コマンド
* 検索キーワード以外にも特殊コマンドで便利な機能がある

```#reload```
設定ファイルの再読み込み(設定ファイルの編集後にやるとよい)

```#edit```
設定ファイルをサクラエディタで開く

```#add```
設定ファイルの最終行に追加

```#restart```
再起動

```#google "任意の文字列"```
"任意の文字列"をgoogleで検索

### 開き方を指定

* 数字の前に開き方を指定するオプションを入れるとそのアプリで開く

例：
```ie 1```
インターネットエクスプローラーで1の場所を開く

* ```ie```:インターネットエクスプローラーで開く
* ```ex```:標準エクスプローラーで開く(今だけはTablacusじゃなくて普通に開きたいときに捗るはず)
* ```cl```:パスを開くのではなくクリップボードにコピーする
* ```ps```:Powershellで開く

### Tablacus Explorerで開くようにする

* https://tablacus.github.io/explorer.html
  と連携できるようにする。
* shortcut.ps1ファイルの設定をいれるところに2つの変数を設定する。

```
$tablacus = $TRUE
$tablacus_exe = "Tablacus Explorerの実行ファイルの場所\TE64.exe"
```


# バージョンメモ

## v1
* 2020/6頃

## v2
* 2022/4/22
* Tablacus Explorerに対応
* ```#add```コマンドを追加
* 開くアプリ指定に```ex```を追加
* 設定ファイルの偶数奇数行制約をなくす
* バグ修正
* README.mdをちゃんと書いた